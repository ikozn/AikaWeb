(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["block"],{1663:function(t,e,r){"use strict";var n=r("a983"),o=r.n(n);o.a},1720:function(t,e,r){"use strict";var n=r("a620"),o=r.n(n);o.a},"308f":function(t,e,r){},"3aa4":function(t,e,r){},"3c3c":function(t,e,r){"use strict";var n=r("8968"),o=r.n(n);o.a},"52e5":function(t,e,r){"use strict";var n=r("91d8"),o=r.n(n);o.a},7249:function(t,e,r){},"7eb8":function(t,e,r){"use strict";var n=r("3aa4"),o=r.n(n);o.a},"7fcb":function(t,e,r){"use strict";var n=r("bb1c"),o=r.n(n);o.a},8968:function(t,e,r){},"91d8":function(t,e,r){},a620:function(t,e,r){},a983:function(t,e,r){},b566:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"blockView",staticClass:"block",on:{mousemove:t.handleMove}},[r("BlockTimeScale"),r("BlockDateCards",{staticClass:"block__date",attrs:{nomargin:t.nomargin},on:{initFloatMsg:t.initFloatMsg}}),r("a-drawer",{attrs:{placement:"right",closable:!1,visible:t.drawerVisible,"get-container":!1,mask:!1,"wrap-style":{position:"absolute"}},on:{close:t.onClose}},[r("BlockCategoryList",{staticClass:"block__categorys"}),r("div",{staticClass:"setting-drawer-index-handle",attrs:{slot:"handle"},slot:"handle"},[r("div",{staticClass:"setting-drawer-togglDrawer",attrs:{slot:"handle"},on:{click:t.togglDrawer},slot:"handle"},[t.drawerVisible?r("a-icon",{attrs:{type:"double-right"}}):r("a-icon",{attrs:{type:"double-left"}})],1),r("BlockActions",{staticClass:"block__actions",attrs:{nomargin:t.nomargin},on:{togglMargin:t.togglMargin}})],1)],1),r("BlockFloatMessage",{directives:[{name:"show",rawName:"v-show",value:t.inMul,expression:"inMul"}],staticClass:"block__float-msg",attrs:{id:"floatMsgBox"}})],1)},o=[],i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"scale"},[r("div",{staticClass:"scale__description"},[r("a-date-picker",{attrs:{placeholder:"选择日期","disabled-date":t.disabledDate},on:{change:t.changeDate}},[r("span",{staticStyle:{cursor:"pointer"}},[t._v(t._s(t.date))])])],1),r("div",{staticClass:"scale__times"},t._l(24,(function(e){return r("div",{key:e,staticClass:"scale__time"},[t._v(" "+t._s(t.formatOclock(e-1))+":00 "),r("a-icon",{attrs:{type:"caret-right"}})],1)})),0)])},s=[],a=r("2f62");function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f={computed:l({date:function(){return new Date(this.visibleDays[0]).getFullYear()+"年"+(new Date(this.visibleDays[0]).getMonth()+1)+"月"}},Object(a["c"])(["visibleDays","originDate","finalDate"])),methods:l({formatOclock:function(t){return t<10?"0"+t:t},changeDate:function(t){this.initVisibleDays(t)},disabledDate:function(t){return t<this.originDate||t>this.finalDate}},Object(a["d"])(["initVisibleDays"]))},b=f,d=(r("1663"),r("2877")),p=Object(d["a"])(b,i,s,!1,null,null,null),h=p.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"block__cards",attrs:{id:"block"},on:{mousedown:t.handleMousedownBlock,mouseover:t.handleOverBlock,click:t.handleClickBlock,contextmenu:function(e){t.floatVisible=!0}}},[r("a-dropdown",{attrs:{trigger:["contextmenu"],visible:t.floatVisible}},[r("div",{ref:"scroll__container",staticClass:"block__scroll",on:{scroll:t.handleScroll,mousewheel:function(e){return e.preventDefault(),t.horizontalScroll(e)}}},[r("div",{ref:"block__container",staticClass:"block__container",class:{nomargin:t.nomargin}},[r("div",{staticClass:"block__cards",style:"transform:translate3d("+t.getPixel(t.visibleDays[0])+"px, 0, 0)"},t._l(t.visibleDays,(function(t){return r("BlockDateCard",{key:t+"c",attrs:{startTime:t}})})),1)])]),r("div",{ref:"float",staticClass:"float__menu",attrs:{slot:"overlay"},on:{contextmenu:function(t){t.preventDefault()},click:function(e){t.floatVisible=!1}},slot:"overlay"},[r("ul",{staticClass:"menu__list float__list"},[t.categorys&&t.categorys.length>0?t._l(t.categorys,(function(e){return r("li",{key:e.id+"rm",staticClass:"item",on:{click:function(r){return r.stopPropagation(),t.setRecord({category:e.id})}}},[r("div",{staticClass:"item__title"},[r("i",{staticClass:"colorBlock",style:"background-color:"+e.color+";"}),r("span",[t._v(" "+t._s(e.name))])]),r("ul",{staticClass:"shortcut-list"},t._l(t.getShortcut(e),(function(n){return r("li",{key:n.id+"rm",staticClass:"shortcut item",on:{click:function(r){return r.stopPropagation(),t.setRecord({category:e.id,event:n.id})}}},[t._v(" "+t._s(n.name)+" ")])})),0)])})):[r("a-tooltip",{attrs:{placement:"top"}},[r("template",{slot:"title"},[r("span",[t._v(" 点击分类卡片上的星星可以收藏分类 收藏的分类会显示在右键菜单里")])]),r("li",{staticClass:"item",on:{click:function(e){return t.$router.push("/category")}}},[r("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"forward"}}),t._v("去收藏分类 ")],1)],2)],r("a-divider",{staticStyle:{"margin-top":".5rem","margin-bottom":".5rem"}}),r("li",{staticClass:"item",on:{click:t.delRecord}},[r("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"delete"}}),t._v("删除记录 ")],1),r("li",{staticClass:"item",on:{click:t.unselect}},[r("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"close-square"}}),t._v("取消选择 ")],1)],2)])])],1)},y=[],m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.reFresh?r("div",{staticClass:"block__card",class:{odd:t.isOdd}},[r("BlockHeader",[r("div",{staticClass:"month",attrs:{slot:"month"},slot:"month"},[t._v(t._s(t.month)+"月")]),r("div",{staticClass:"date",attrs:{slot:"date"},slot:"date"},[t._v(t._s(t.date))]),r("div",{staticClass:"day",attrs:{slot:"day"},slot:"day"},[t._v("周"+t._s(t.day))]),r("div",{staticClass:"recent",attrs:{slot:"recent"},slot:"recent"},[r("span",{class:t.recent.class},[t._v(t._s(t.recent.str))])])]),r("BlockDay",{attrs:{startTime:t.startTime}})],1):t._e()},v=[],O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"block__day"},[t.loading?r("div",{staticClass:"loading"},[r("a-spin",[r("a-icon",{staticStyle:{"font-size":"24px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1)],1):r("div",{staticClass:"block__grid",class:t.size},t._l(t.times,(function(t){return r("Block",{key:t+"bk",attrs:{time:t}})})),1)])},j=[],w=r("a34a"),k=r.n(w),_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.loading?t._e():r("div",{staticClass:"block__block",class:{chosen:t.chosen},style:{backgroundColor:t.category.color},attrs:{id:t.time}},[r("span",{staticClass:"block-eventStr"},[r("span",{attrs:{name:"message"}},[t._v(t._s(t.message))]),r("span",{staticClass:"block__lable"},[r("a-icon",{staticClass:"block__check",attrs:{type:"check"}})],1)])])},P=[];function D(t,e){return E(t)||C(t,e)||B(t,e)||S()}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)if(r.push(s.value),e&&r.length===e)break}catch(c){o=!0,i=c}finally{try{n||null==a["return"]||a["return"]()}finally{if(o)throw i}}return r}}function E(t){if(Array.isArray(t))return t}function x(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=B(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function B(t,e){if(t){if("string"===typeof t)return M(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(t,e):void 0}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $(t,e,r,n,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void r(l)}a.done?e(c):Promise.resolve(c).then(n,o)}function T(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){$(i,n,o,s,a,"next",t)}function a(t){$(i,n,o,s,a,"throw",t)}s(void 0)}))}}function A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach((function(e){L(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function L(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var I={props:["time"],data:function(){return{loading:!0,category:{},event:{},message:"",color:"",chosen:!1}},watch:{logs:function(){this.initBlock()}},computed:V({logs:function(){return this.$store.getters.logs}},Object(a["c"])(["setting","selectedBlocks","blocksState","categorys","events"])),mounted:function(){this.initBlock()},methods:{initBlock:function(){var t=this;return T(k.a.mark((function e(){return k.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.category=Object.freeze(t.getCategory()),t.event=Object.freeze(t.getEvent()),t.chosen=Object.freeze(t.getChosen()),t.color=t.getColor(),t.message=t.getMessage(),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},getCategory:function(){var t=this.blocksState[this.time];return t&&this.categorys[t.category]||{}},getEvent:function(){var t=this.blocksState[this.time];return t&&t.event&&this.events[t.event]||{}},getChosen:function(){return!!this.selectedBlocks[this.time]},getColor:function(){return this.category.color},getMessage:function(){var t=this.blocksState[this.time];if(this.hasCategory(t)){for(var e=this.blocksState[this.time-60*parseInt(this.setting.block.size)*1e3],r=["category","event","description"],n=!0,o=0,i=r;o<i.length;o++){var s=i[o];if(void 0===e||void 0===t||e[s]!==t[s]){n=!1;break}}if(n)return"...";var a,c=[],l=this.setting.block.showField,u=x(l);try{for(u.s();!(a=u.n()).done;){var f=a.value,b=f.split("."),d=D(b,2),p=d[0],h=d[1];if(t[p]){var g=this[p+"s"][t[p]][h];g||(g=""),c.push(g)}}}catch(y){u.e(y)}finally{u.f()}return c.filter((function(t){return t&&t.length>0})).join("-")}},hasCategory:function(t){return Boolean(t&&this.categorys[t.category])}}},R=I,z=(r("7eb8"),Object(d["a"])(R,_,P,!1,null,null,null)),F=z.exports;function J(t,e,r,n,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void r(l)}a.done?e(c):Promise.resolve(c).then(n,o)}function N(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){J(i,n,o,s,a,"next",t)}function a(t){J(i,n,o,s,a,"throw",t)}s(void 0)}))}}function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function U(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){Y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var W={props:["startTime"],data:function(){return{loading:!0,size:"",times:[]}},mounted:function(){this.initBlocks()},components:{Block:F},computed:U({},Object(a["c"])(["setting"])),methods:U(U({},Object(a["b"])(["renderDay","set"])),{},{initBlocks:function(){var t=this;return N(k.a.mark((function e(){var r;return k.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.renderDay(t.startTime);case 2:for(r=t.startTime;r<t.startTime+864e5;r+=60*parseInt(t.setting.block.size)*1e3)t.times.push(r);t.size=t.getSize(),t.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},getSize:function(){var t=parseInt(this.setting.block.size);switch(t){case 5:return"block-min";case 15:return"block-med";default:return"block-max"}}})},q=W,X=(r("1720"),Object(d["a"])(q,O,j,!1,null,null,null)),G=X.exports,K=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"describe"},[t._t("month"),t._t("date"),t._t("day"),t._t("recent")],2)},Q=[],Z={},tt=Z,et=(r("7fcb"),Object(d["a"])(tt,K,Q,!1,null,null,null)),rt=et.exports;function nt(t){return at(t)||st(t)||it(t)||ot()}function ot(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function it(t,e){if(t){if("string"===typeof t)return ct(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ct(t,e):void 0}}function st(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function at(t){if(Array.isArray(t))return ct(t)}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ut(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(r),!0).forEach((function(e){ft(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ft(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bt={props:["startTime"],data:function(){return{reFresh:!0}},components:{BlockDay:G,BlockHeader:rt},computed:ut({month:function(){var t=[].concat(nt("一二三四五六七八九十"),["十一","十二"]),e=new Date(this.startTime);return t[e.getMonth()]},date:function(){return new Date(this.startTime).getDate()},day:function(){var t="日一二三四五六";return t[new Date(this.startTime).getDay()]},recent:function(){var t=new Date,e=864e5,r=new Date("".concat(t.getFullYear(),"/").concat(t.getMonth()+1,"/").concat(t.getDate())).getTime(),n={class:null,str:null};switch(this.startTime){case r-2*e:n={class:"dby",str:"前天"};break;case r-e:n={class:"yest",str:"昨天"};break;case r:n={class:"today",str:"今天"};break;case r+e:n={class:"tomr",str:"明天"};break;case r+2*e:n={class:"dat",str:"后天"};break}return n},isOdd:function(){return(this.startTime-this.originDate)/864e5%2}},Object(a["c"])(["originDate"]))},dt=bt,pt=(r("3c3c"),Object(d["a"])(dt,m,v,!1,null,null,null)),ht=pt.exports;function gt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function yt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(r),!0).forEach((function(e){mt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function mt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vt=null,Ot=null,jt={methods:yt({longPressStart:function(t){var e=this;"click"===t.type&&0!==t.button||!t.target.closest(".block__block")||null===vt&&(vt=setTimeout((function(){e.handleLongPress(t)}),500))},longPressCancelLongPress:function(){null!==vt&&(clearTimeout(vt),vt=null)},longPressCancelMul:function(){this.longPressCancelLongPress(),this.cancelMultiSel()},longPressAddListener:function(){var t=this;["mousedown","touchstart"].forEach((function(e){return Ot.addEventListener(e,t.longPressStart)})),Array("touchend","touchcancel","mouseout","mouseover").forEach((function(e){return Ot.addEventListener(e,t.longPressCancelLongPress)})),Ot.addEventListener("mouseup",this.longPressCancelMul)},longPressRemoveListener:function(){var t=this;["mousedown","touchstart"].forEach((function(e){return Ot.removeEventListener(e,t.longPressStart)})),Array("touchend","touchcancel","mouseout","mouseover").forEach((function(e){return Ot.removeEventListener(e,t.longPressCancelLongPress)})),Ot.removeEventListener("mouseup",this.longPressCancelMul)},initLongPress:function(){Ot=document.getElementById("block"),this.longPressAddListener()},handleLongPress:function(t){this.initMultiSel(),this.$emit("initFloatMsg",{top:t.clientY,left:t.clientX})}},Object(a["d"])(["cancelMultiSel","initMultiSel"]))};function wt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function kt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(r),!0).forEach((function(e){_t(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Pt={methods:kt({initScrollView:function(){var t=this;this.$nextTick((function(){t.$refs.block__container.style.width=t.cardWidth*t.days.length+"px",t.initScroll(),window.addEventListener("resize",t.handleResize)}))},initScroll:function(){this.$refs.scroll__container.scrollTo(this.getPixel(this.visibleDays[0]),this.$refs.scroll__container.scrollTop)},handleScroll:function(t){var e=t.target,r=e.scrollLeft,n=e.clientWidth;this.updatedVisibleDays({scrollLeft:r,clientWidth:n})},handleResize:function(){var t=this;if(this.$refs.scroll__container){var e=this.$refs.scroll__container,r=e.scrollLeft,n=e.clientWidth;this.$nextTick((function(){t.updatedVisibleDays({scrollLeft:r,clientWidth:n})}))}},horizontalScroll:function(t){var e=-t.wheelDelta/120;this.$refs.scroll__container.scrollLeft+=50*e},getPixel:function(t){var e=(t-this.originDate)/864e5*this.cardWidth;return e}},Object(a["d"])(["updatedVisibleDays"]))};function Dt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function St(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(r),!0).forEach((function(e){Ct(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ct(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Et={props:["nomargin"],mixins:[jt,Pt],components:{BlockDateCard:ht},data:function(){return{floatVisible:!1}},computed:St({categorys:function(){var t=this,e=[],r=this.$store.getters.categorys,n=function(n){var o=r[n];o.active&&o.star&&(o.shortcut.forEach((function(e,r){t.events[e]||o.shortcut.splice(r,1)})),e.push(o))};for(var o in r)n(o);return e}},Object(a["c"])(["events","days","scrollToDay","visibleDays","originDate","finalDate","cardWidth","inMul"])),watch:{scrollToDay:function(){this.initScrollView()}},mounted:function(){this.initDays(),this.initVisibleDays(),this.initScrollView(),this.initLongPress()},methods:St(St({handleOverBlock:function(t){t.target.matches(".block__block, .block__block *")&&this.updatedMulInterval(parseInt(t.target.closest(".block__block").id))},handleMousedownBlock:function(t){this.floatVisible=!1,t.target.matches(".block__block, .block__block *")&&this.setMultiSelStart(parseInt(t.target.closest(".block__block").id))},handleClickBlock:function(t){var e=t.target.closest(".block__block");if(e){var r=parseInt(e.id);e.matches(".chosen")?(this.decSelDayByTime(r),this.delSelBlock(r)):(this.incSelDayByTime(r),this.addSelBlock(r))}},getShortcut:function(t){var e=this,r=[];return t.shortcut.forEach((function(t){e.events[t]&&e.events[t].active&&r.push(e.events[t])})),r},setRecord:function(t){this.floatVisible=!1,this.$store.dispatch("setRecord",t)}},Object(a["b"])(["updatedMulInterval","delRecord","unselect"])),Object(a["d"])(["initDays","initVisibleDays","incSelDayByTime","decSelDayByTime","addSelBlock","delSelBlock","setMultiSelStart"])),beforeDestroy:function(){this.longPressRemoveListener()}},xt=Et,Bt=(r("e6cf"),Object(d["a"])(xt,g,y,!1,null,null,null)),Mt=Bt.exports,$t=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"block__actions",staticStyle:{"background-color":"#fff"}},[t.eventsAllVisible?r("ChooseEvent",{attrs:{visible:t.eventsAllVisible,category:t.nowCategory},on:{cancel:t.hideEventsAll,create:t.selectEvent}}):t._e(),r("div",{staticClass:"search"},[r("a-input",{attrs:{placeholder:"搜索分类名、描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[r("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1)],1),r("div",{staticClass:"block__actions--container"},[t.categorysTable&&t.categorysTable.length>0?[r("a-table",{attrs:{columns:t.columns,"data-source":t.categorysTable,size:"middle",pagination:!1,showHeader:!1,bordered:!1,customRow:t.customRow,locale:{emptyText:"无分类"}},scopedSlots:t._u([{key:"name",fn:function(e,n){return[r("a-tooltip",{staticClass:"category__item",attrs:{placement:"topLeft"}},[r("template",{slot:"title"},[r("span",[t._v(t._s(n.description))])]),"category"===n.type?r("span",{staticClass:"category__item--color",style:"background-color: "+n.color}):t._e(),t._v(" "+t._s(n.name)+" ")],2)]}},{key:"action",fn:function(e,n){return[e?r("a-tooltip",{staticClass:"category__item",attrs:{placement:"left"}},[r("template",{slot:"title"},[r("span",[t._v("更多事件")])]),r("a-icon",{staticClass:"more",attrs:{type:"right-square"},on:{click:function(e){return e.stopPropagation(),t.showEventsAll(n.category)}}})],2):t._e()]}}],null,!1,3151185850)})]:[r("a-result",{attrs:{"sub-title":t.search?"没有符合条件的分类噢":"还没有分类噢"},scopedSlots:t._u([{key:"icon",fn:function(){return[r("a-icon",{attrs:{type:"smile",theme:"twoTone"}})]},proxy:!0},{key:"extra",fn:function(){return[r("a-button",{attrs:{type:"dashed"},on:{click:function(e){return t.$router.push("/category")}}},[t._v(" 去添加分类 ")])]},proxy:!0}])})]],2)],1)},Tt=[],At=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-modal",{attrs:{visible:t.visible,title:"设置分类["+t.categorys[t.category].name+"]并指定事件为:",footer:null},on:{cancel:function(){t.$emit("cancel")}}},[r("a-input",{attrs:{placeholder:"搜索事件名、描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[r("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1),r("a-list",{attrs:{"item-layout":"horizontal","data-source":t.events,pagination:t.pagination,locale:{emptyText:"无事件"}},scopedSlots:t._u([{key:"renderItem",fn:function(e){return r("a-list-item",{on:{click:function(r){return t.$emit("create",{category:t.category,event:e.id})}}},[r("a-list-item-meta",{attrs:{description:e.description}},[r("a",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name)+"["+t._s(e.abbr)+"]")])])],1)}}])})],1)},Vt=[];function Lt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function It(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(r),!0).forEach((function(e){Rt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Rt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zt={props:["visible","category"],data:function(){return{search:"",pagination:{pageSize:5}}},computed:It({events:function(){var t=[],e=this.$store.getters.events;for(var r in e)e[r].active&&(e[r].name.match(this.search)||e[r].description.match(this.search))&&t.push(e[r]);return t}},Object(a["c"])(["categorys"]))},Ft=zt,Jt=Object(d["a"])(Ft,At,Vt,!1,null,null,null),Nt=Jt.exports;function Ht(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=Ut(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function Ut(t,e){if(t){if("string"===typeof t)return Yt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yt(t,e):void 0}}function Yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Wt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function qt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(r),!0).forEach((function(e){Xt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Xt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Gt=[{title:"分类",dataIndex:"name",key:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"},align:"right",width:50}],Kt=function(t){return function(e){return{props:{test:10},on:{click:function(){t(e)}}}}},Qt={components:{ChooseEvent:Nt},data:function(){return{eventsAllVisible:!1,columns:Gt,customRow:Kt(this.record),search:"",nowCategory:""}},computed:qt({categorysTable:function(){var t=[],e=0;for(var r in this.categorys){var n=this.categorys[r],o=n.name,i=n.color,s=n.description,a=n.shortcut,c=n.active,l=c&&(o.match(this.search)||s.match(this.search));if(l){var u,f={key:e++,category:r,name:o,color:i,description:s,type:"category",action:!0,children:[]},b=Ht(a);try{for(b.s();!(u=b.n()).done;){var d=u.value;if(d){var p=this.events[d],h=p.name,g=p.description,y=p.active;if(h&&y){var m={key:e++,category:r,event:d,type:"event",name:h,description:g};f.children.push(m)}}}}catch(v){b.e(v)}finally{b.f()}f.children.length||delete f.children,t.push(f)}}return t}},Object(a["c"])(["categorys","events","hasChosen"])),methods:qt({showEventsAll:function(t){this.hasChosen?(this.eventsAllVisible=!0,this.nowCategory=t):this.$message.error("未选择块")},hideEventsAll:function(){this.eventsAllVisible=!1},selectEvent:function(t){this.eventsAllVisible=!1,this.record(t)},record:function(t){this.setRecord(t)}},Object(a["b"])(["createCategory","setRecord"]))},Zt=Qt,te=(r("bb50"),Object(d["a"])(Zt,$t,Tt,!1,null,null,null)),ee=te.exports,re=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.editDesVisible?r("EditDescription",{on:{cancel:t.hideEditDesView,edit:t.changeDes}}):t._e(),r("a-dropdown",{attrs:{trigger:["hover"],placement:"topRight"}},[r("a-button",{staticStyle:{position:"absolute",bottom:"1rem",right:"28rem","z-index":"10"},attrs:{icon:"menu",size:"large"}}),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"nomargin",on:{click:t.togglMargin}},[t.nomargin?r("a-icon",{attrs:{type:"column-height"}}):r("a-icon",{attrs:{type:"vertical-align-middle"}}),t._v(" "+t._s(t.nomargin?"开启":"关闭")+"间隔 ")],1),r("a-menu-item",{key:"export",on:{click:t.exportData}},[r("a-icon",{attrs:{type:"export"}}),t._v("导出数据 ")],1),r("a-menu-item",{key:"uploadData"},[r("a-icon",{attrs:{type:"upload"}}),r("a-upload",{attrs:{name:"file","before-upload":t.beforeUpdate,showUploadList:!1},on:{change:t.handleChange}},[t._v("导入数据 ")])],1),r("a-menu-item",{key:"addDescription",on:{click:t.showEditDesView}},[r("a-icon",{attrs:{type:"file-text"}}),t._v("添加描述 ")],1),r("a-menu-item",{key:"deleteRecord",on:{click:t.delRecord}},[r("a-icon",{attrs:{type:"delete"}}),t._v("删除记录 ")],1),r("a-menu-item",{key:"unselect",on:{click:t.unselect}},[r("a-icon",{attrs:{type:"close-square"}}),t._v("取消选择 ")],1)],1)],1)],1)},ne=[],oe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-modal",{attrs:{visible:!0,title:"设置描述",okText:"保存",cancelText:"取消"},on:{cancel:function(e){return t.$emit("cancel")},ok:function(e){return t.$emit("edit",t.value)}}},[r("a-textarea",{attrs:{placeholder:"输入描述","allow-clear":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},ie=[];function se(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ae(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?se(Object(r),!0).forEach((function(e){ce(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ce(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var le={data:function(){return{value:""}},methods:{},computed:ae({},Object(a["c"])(["categorys"]))},ue=le,fe=Object(d["a"])(ue,oe,ie,!1,null,null,null),be=fe.exports;class de{constructor(){}exportJSON(t={},e){let r=document.createElement("a");e||(e=Date.now()+".json"),/\.json$/.test(e)||(e+=".json"),r.download=e,r.href="data:text/plain,"+JSON.stringify(t),r.click(),r=null}importJSON(){return new Promise((t,e)=>{let r=document.createElement("input");r.type="file",r.onchange=n=>{let o=n.target.files;o&&o.length||(r=null,e(new Error("No files")));let i=new FileReader;i.onload=n=>{try{let e=JSON.parse(n.target.result);t(e)}catch(o){e(o)}r=null},i.readAsText(o[0])},r.click()})}}var pe=new de,he=r("c1df"),ge=r.n(he);function ye(t,e,r,n,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void r(l)}a.done?e(c):Promise.resolve(c).then(n,o)}function me(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){ye(i,n,o,s,a,"next",t)}function a(t){ye(i,n,o,s,a,"throw",t)}s(void 0)}))}}function ve(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(r),!0).forEach((function(e){je(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function je(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var we={props:["nomargin"],components:{EditDescription:be},data:function(){return{editDesVisible:!1}},computed:Oe({},Object(a["c"])(["hasChosen","selectedBlocks","blocksState","setting","events","categorys","setting"])),methods:Oe({hideEditDesView:function(){this.editDesVisible=!1},showEditDesView:function(){if(this.hasChosen){for(var t=!1,e=this.selectedBlocks,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(!this.blocksState[o]){t=!0;break}}t?this.$message.error("有未标记的块"):this.editDesVisible=!0}else this.$message.error("未选择块")},togglMargin:function(){this.$emit("togglMargin")},changeDes:function(t){this.editDesVisible=!1,""===t.trim()&&(t=void 0),this.setDes(t)},exportData:function(){var t=this;return me(k.a.mark((function e(){var r,n,o,i,s,a;return k.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.events,n=t.categorys,e.next=4,t.getLogsAll();case 4:o=e.sent,i=t.setting,s={events:r,categorys:n,logs:o,setting:i},a=btoa(encodeURIComponent(JSON.stringify(s))),pe.exportJSON(a,"AikaData - ".concat(ge()().format("YYYY-MM-DD HH:mm:ss"),".json"));case 9:case"end":return e.stop()}}),e)})))()},beforeUpdate:function(){return!1},handleChange:function(t){var e=this;if("uploading"!==t.file.status)try{var r=new FileReader;r.onload=function(r){try{var n=JSON.parse(r.target.result),o=JSON.parse(decodeURI(decodeURI(atob(n))).replace(/%3A/g,":").replace(/%2C/g,",").replace(/%23/g,"#")),i=[];return i.push(e.setLogsByFile(o.logs)),i.push(e.setCategorysByFile(o.categorys)),i.push(e.setEventsByFile(o.events)),i.push(e.setSettingByFile(o.setting)),Promise.all(i).then((function(){e.$message.success("数据导入成功"),setTimeout((function(){return e.$router.go(0)}),800)})),n}catch(s){throw e.$message.error("".concat(t.file.name," 导入失败.")),new Error(s)}},r.readAsText(t.file)}catch(n){this.$message.error("".concat(t.file.name," 导入失败.")),console.error(n)}"done"===t.file.status?this.$message.success("".concat(t.file.name," 导入成功")):"error"===t.file.status&&this.$message.error("".concat(t.file.name," 导入失败."))}},Object(a["b"])(["delRecord","unselect","setDes","getLogsAll","setLogsByFile","setCategorysByFile","setEventsByFile","setSettingByFile"]))},ke=we,_e=Object(d["a"])(ke,re,ne,!1,null,null,null),Pe=_e.exports,De=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"float-msg"},[r("span",{staticClass:"float-interval"},[t._v(t._s(t.selInterval))]),r("span",{staticClass:"float-duration"},[t._v(t._s(t.selDuration))])])},Se=[];function Ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ee(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(r),!0).forEach((function(e){xe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function xe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Be={computed:Ee({selInterval:function(){var t=this.selectStart,e=this.selectEnd;if(t>e){var r=[e,t];t=r[0],e=r[1]}return ge()(t).format("HH:mm")+"~"+ge()(e+60*this.setting.block.size*1e3).format("HH:mm")},selDuration:function(){var t=this.selectStart,e=this.selectEnd;if(t>e){var r=[e,t];t=r[0],e=r[1]}e+=60*this.setting.block.size*1e3;var n=(e-t)/1e3/60,o=Math.floor(n/60),i=n%60,s=o?o+"小时":"",a=i?i+"分钟":"";return s+a}},Object(a["c"])(["selectStart","selectEnd","setting"]))},Me=Be,$e=(r("52e5"),Object(d["a"])(Me,De,Se,!1,null,null,null)),Te=$e.exports,Ae={components:{BlockTimeScale:h,BlockDateCards:Mt,BlockCategoryList:ee,BlockActions:Pe,BlockFloatMessage:Te},data:function(){return{nomargin:!1,floatMsgBox:null,drawerVisible:!0}},computed:{inMul:function(){return this.$store.getters.inMul}},mounted:function(){var t=this;this.$nextTick((function(){t.getFloatMsg()}))},methods:{moment:ge.a,togglDrawer:function(){this.drawerVisible=!this.drawerVisible},afterVisibleChange:function(t){console.log("visible",t)},showDrawer:function(){this.visible=!0},onClose:function(){this.visible=!1},getFloatMsg:function(){this.floatMsgBox=document.getElementById("floatMsgBox")},initFloatMsg:function(t){var e=t.top,r=t.left;this.setPosition(e,r)},handleMove:function(t){this.inMul&&this.setPosition(t.clientY,t.clientX)},setPosition:function(t,e){this.floatMsgBox||this.getFloatMsg(),this.floatMsgBox.style.top=t-80+"px",this.floatMsgBox.style.left=e-120+"px"},togglMargin:function(){this.nomargin=!this.nomargin}}},Ve=Ae,Le=(r("db1b"),Object(d["a"])(Ve,n,o,!1,null,null,null));e["default"]=Le.exports},bb1c:function(t,e,r){},bb50:function(t,e,r){"use strict";var n=r("7249"),o=r.n(n);o.a},db1b:function(t,e,r){"use strict";var n=r("f12d"),o=r.n(n);o.a},e6cf:function(t,e,r){"use strict";var n=r("308f"),o=r.n(n);o.a},f12d:function(t,e,r){}}]);
//# sourceMappingURL=block.70152d06.js.map