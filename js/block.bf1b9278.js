(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["block"],{1663:function(t,e,n){"use strict";var r=n("a983"),o=n.n(r);o.a},1720:function(t,e,n){"use strict";var r=n("a620"),o=n.n(r);o.a},"308f":function(t,e,n){},"3aa4":function(t,e,n){},"3c3c":function(t,e,n){"use strict";var r=n("8968"),o=n.n(r);o.a},"52e5":function(t,e,n){"use strict";var r=n("91d8"),o=n.n(r);o.a},7249:function(t,e,n){},"7eb8":function(t,e,n){"use strict";var r=n("3aa4"),o=n.n(r);o.a},"7fcb":function(t,e,n){"use strict";var r=n("bb1c"),o=n.n(r);o.a},8968:function(t,e,n){},"91d8":function(t,e,n){},a620:function(t,e,n){},a983:function(t,e,n){},b566:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"blockView",staticClass:"block",on:{mousemove:t.handleMove}},[n("BlockTimeScale"),n("BlockDateCards",{staticClass:"block__date",attrs:{nomargin:t.nomargin},on:{initFloatMsg:t.initFloatMsg}}),n("a-drawer",{attrs:{placement:"right",closable:!1,visible:t.drawerVisible,"get-container":!1,mask:!1,"wrap-style":{position:"absolute"}},on:{close:t.onClose}},[n("BlockCategoryList",{staticClass:"block__categorys"}),n("div",{staticClass:"setting-drawer-index-handle",attrs:{slot:"handle"},slot:"handle"},[n("div",{staticClass:"setting-drawer-togglDrawer",attrs:{slot:"handle"},on:{click:t.togglDrawer},slot:"handle"},[t.drawerVisible?n("a-icon",{attrs:{type:"double-right"}}):n("a-icon",{attrs:{type:"double-left"}})],1),n("BlockActions",{staticClass:"block__actions",attrs:{nomargin:t.nomargin},on:{togglMargin:t.togglMargin}})],1)],1),n("BlockFloatMessage",{directives:[{name:"show",rawName:"v-show",value:t.inMul,expression:"inMul"}],staticClass:"block__float-msg",attrs:{id:"floatMsgBox"}})],1)},o=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scale"},[n("div",{staticClass:"scale__description"},[n("a-date-picker",{attrs:{placeholder:"选择日期","disabled-date":t.disabledDate},on:{change:t.changeDate}},[n("span",{staticStyle:{cursor:"pointer"}},[t._v(t._s(t.date))])])],1),n("div",{staticClass:"scale__times"},t._l(24,(function(e){return n("div",{key:e,staticClass:"scale__time"},[t._v(" "+t._s(t.formatOclock(e-1))+":00 "),n("a-icon",{attrs:{type:"caret-right"}})],1)})),0)])},s=[],a=n("2f62");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={computed:l({date:function(){return new Date(this.visibleDays[0]).getFullYear()+"年"+(new Date(this.visibleDays[0]).getMonth()+1)+"月"}},Object(a["c"])(["visibleDays","originDate","finalDate"])),methods:l({formatOclock:function(t){return t<10?"0"+t:t},changeDate:function(t){this.initVisibleDays(t)},disabledDate:function(t){return t<this.originDate||t>this.finalDate}},Object(a["d"])(["initVisibleDays"]))},d=f,h=(n("1663"),n("2877")),p=Object(h["a"])(d,i,s,!1,null,null,null),b=p.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"block__cards",attrs:{id:"block"},on:{mousedown:t.handleMousedownBlock,mouseover:t.handleOverBlock,click:t.handleClickBlock,contextmenu:function(e){t.floatVisible=!0}}},[n("a-dropdown",{attrs:{trigger:["contextmenu"],visible:t.floatVisible}},[n("div",{ref:"scroll__container",staticClass:"block__scroll",on:{scroll:t.handleScroll,mousewheel:function(e){return e.preventDefault(),t.horizontalScroll(e)}}},[n("div",{ref:"block__container",staticClass:"block__container",class:{nomargin:t.nomargin}},[n("div",{staticClass:"block__cards",style:"transform:translate3d("+t.getPixel(t.visibleDays[0])+"px, 0, 0)"},t._l(t.visibleDays,(function(t){return n("BlockDateCard",{key:t+"c",attrs:{startTime:t}})})),1)])]),n("div",{ref:"float",staticClass:"float__menu",attrs:{slot:"overlay"},on:{contextmenu:function(t){t.preventDefault()},click:function(e){t.floatVisible=!1}},slot:"overlay"},[n("ul",{staticClass:"menu__list float__list"},[t.categorys&&t.categorys.length>0?t._l(t.categorys,(function(e){return n("li",{key:e.id+"rm",staticClass:"item",on:{click:function(n){return n.stopPropagation(),t.setRecord({category:e.id})}}},[n("div",{staticClass:"item__title"},[n("i",{staticClass:"colorBlock",style:"background-color:"+e.color+";"}),n("span",[t._v(" "+t._s(e.name))])]),n("ul",{staticClass:"shortcut-list"},t._l(t.getShortcut(e),(function(r){return n("li",{key:r.id+"rm",staticClass:"shortcut item",on:{click:function(n){return n.stopPropagation(),t.setRecord({category:e.id,event:r.id})}}},[t._v(" "+t._s(r.name)+" ")])})),0)])})):[n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[n("span",[t._v(" 点击分类卡片上的星星可以收藏分类 收藏的分类会显示在右键菜单里")])]),n("li",{staticClass:"item",on:{click:function(e){return t.$router.push("/category")}}},[n("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"forward"}}),t._v("去收藏分类 ")],1)],2)],n("a-divider",{staticStyle:{"margin-top":".5rem","margin-bottom":".5rem"}}),n("li",{staticClass:"item",on:{click:t.delRecord}},[n("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"delete"}}),t._v("删除记录 ")],1),n("li",{staticClass:"item",on:{click:t.unselect}},[n("a-icon",{staticStyle:{"margin-right":"1rem"},attrs:{type:"close-square"}}),t._v("取消选择 ")],1)],2)])])],1)},y=[],m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.reFresh?n("div",{staticClass:"block__card",class:{odd:t.isOdd}},[n("BlockHeader",[n("div",{staticClass:"month",attrs:{slot:"month"},slot:"month"},[t._v(t._s(t.month)+"月")]),n("div",{staticClass:"date",attrs:{slot:"date"},slot:"date"},[t._v(t._s(t.date))]),n("div",{staticClass:"day",attrs:{slot:"day"},slot:"day"},[t._v("周"+t._s(t.day))]),n("div",{staticClass:"recent",attrs:{slot:"recent"},slot:"recent"},[n("span",{class:t.recent.class},[t._v(t._s(t.recent.str))])])]),n("BlockDay",{attrs:{startTime:t.startTime}})],1):t._e()},v=[],O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"block__day"},[t.loading?n("div",{staticClass:"loading"},[n("a-spin",[n("a-icon",{staticStyle:{"font-size":"24px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1)],1):n("div",{staticClass:"block__grid",class:t.size},t._l(t.times,(function(t){return n("Block",{key:t+"bk",attrs:{time:t}})})),1)])},k=[],_=n("a34a"),w=n.n(_),j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?t._e():n("div",{staticClass:"block__block",class:{chosen:t.chosen},style:{backgroundColor:t.category.color},attrs:{id:t.time}},[n("span",{staticClass:"block-eventStr"},[n("span",{attrs:{name:"message"}},[t._v(t._s(t.message))]),n("span",{staticClass:"block__lable"},[n("a-icon",{staticClass:"block__check",attrs:{type:"check"}})],1)])])},D=[];function P(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(r,o)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){P(i,r,o,s,a,"next",t)}function a(t){P(i,r,o,s,a,"throw",t)}s(void 0)}))}}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var B={props:["time"],data:function(){return{loading:!0,category:{},event:{},message:"",color:"",chosen:!1}},watch:{logs:function(){this.initBlock()}},computed:x({logs:function(){return this.$store.getters.logs}},Object(a["c"])(["setting","selectedBlocks","blocksState","categorys","events"])),mounted:function(){this.initBlock()},methods:{initBlock:function(){var t=this;return S(w.a.mark((function e(){return w.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.category=Object.freeze(t.getCategory()),t.event=Object.freeze(t.getEvent()),t.chosen=Object.freeze(t.getChosen()),t.color=t.getColor(),t.message=t.getMessage(),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},getCategory:function(){var t=this.blocksState[this.time];return t&&this.categorys[t.category]||{}},getEvent:function(){var t=this.blocksState[this.time];return t&&t.event&&this.events[t.event]||{}},getChosen:function(){return!!this.selectedBlocks[this.time]},getColor:function(){return this.category.color},getMessage:function(){var t=this.blocksState[this.time];if(this.hasCategory(t)){var e=!0,n=!0,r=this.setting.block.style;switch(r){case"neither":return"";case"category":n=!1;break;case"event":e=!1;break}for(var o=this.blocksState[this.time-60*parseInt(this.setting.block.size)*1e3],i=["category","event","description"],s=!0,a=0,c=i;a<c.length;a++){var l=c[a];if(void 0===o||void 0===t||o[l]!==t[l]){s=!1;break}}var u=[];u.push(e?this.category.name:""),u.push(n?this.event.abbr:"");var f=u.filter((function(t){return t&&t.length>0})).join("-");return s&&f?"...":f}},hasCategory:function(t){return Boolean(t&&this.categorys[t.category])}}},M=B,$=(n("7eb8"),Object(h["a"])(M,j,D,!1,null,null,null)),T=$.exports;function V(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(r,o)}function L(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){V(i,r,o,s,a,"next",t)}function a(t){V(i,r,o,s,a,"throw",t)}s(void 0)}))}}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var I={props:["startTime"],data:function(){return{loading:!0,size:"",times:[]}},mounted:function(){this.initBlocks()},components:{Block:T},computed:R({},Object(a["c"])(["setting"])),methods:R(R({},Object(a["b"])(["renderDay","set"])),{},{initBlocks:function(){var t=this;return L(w.a.mark((function e(){var n;return w.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.renderDay(t.startTime);case 2:for(n=t.startTime;n<t.startTime+864e5;n+=60*parseInt(t.setting.block.size)*1e3)t.times.push(n);t.size=t.getSize(),t.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},getSize:function(){var t=parseInt(this.setting.block.size);switch(t){case 5:return"block-min";case 15:return"block-med";default:return"block-max"}}})},A=I,J=(n("1720"),Object(h["a"])(A,O,k,!1,null,null,null)),N=J.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"describe"},[t._t("month"),t._t("date"),t._t("day"),t._t("recent")],2)},Y=[],U={},W=U,q=(n("7fcb"),Object(h["a"])(W,H,Y,!1,null,null,null)),X=q.exports;function G(t){return tt(t)||Z(t)||Q(t)||K()}function K(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Q(t,e){if(t){if("string"===typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function Z(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function tt(t){if(Array.isArray(t))return et(t)}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){ot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var it={props:["startTime"],data:function(){return{reFresh:!0}},components:{BlockDay:N,BlockHeader:X},computed:rt({month:function(){var t=[].concat(G("一二三四五六七八九十"),["十一","十二"]),e=new Date(this.startTime);return t[e.getMonth()]},date:function(){return new Date(this.startTime).getDate()},day:function(){var t="日一二三四五六";return t[new Date(this.startTime).getDay()]},recent:function(){var t=new Date,e=864e5,n=new Date("".concat(t.getFullYear(),"/").concat(t.getMonth()+1,"/").concat(t.getDate())).getTime(),r={class:null,str:null};switch(this.startTime){case n-2*e:r={class:"dby",str:"前天"};break;case n-e:r={class:"yest",str:"昨天"};break;case n:r={class:"today",str:"今天"};break;case n+e:r={class:"tomr",str:"明天"};break;case n+2*e:r={class:"dat",str:"后天"};break}return r},isOdd:function(){return(this.startTime-this.originDate)/864e5%2}},Object(a["c"])(["originDate"]))},st=it,at=(n("3c3c"),Object(h["a"])(st,m,v,!1,null,null,null)),ct=at.exports;function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){ft(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ft(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var dt={props:["nomargin"],components:{BlockDateCard:ct},data:function(){return{floatVisible:!1}},computed:ut({categorys:function(){var t=this,e=[],n=this.$store.getters.categorys,r=function(r){var o=n[r];o.active&&o.star&&(o.shortcut.forEach((function(e,n){t.events[e]||o.shortcut.splice(n,1)})),e.push(o))};for(var o in n)r(o);return e}},Object(a["c"])(["events","days","scrollToDay","visibleDays","originDate","finalDate","cardWidth","inMul"])),watch:{scrollToDay:function(){this.initScrollView()}},mounted:function(){this.initDays(),this.initVisibleDays(),this.initScrollView(),this.initLongPress()},methods:ut(ut({initScrollView:function(){var t=this;this.$nextTick((function(){t.$refs.block__container.style.width=t.cardWidth*t.days.length+"px",t.initScroll(),window.addEventListener("resize",t.handleResize)}))},initScroll:function(){this.$refs.scroll__container.scrollTo(this.getPixel(this.visibleDays[0]),this.$refs.scroll__container.scrollTop)},initLongPress:function(){var t=this,e=null,n=document.getElementById("block"),r=function(n){"click"===n.type&&0!==n.button||!n.target.closest(".block__block")||null===e&&(e=setTimeout((function(){t.handleLongPress(n)}),500))},o=function(){null!==e&&(clearTimeout(e),e=null)},i=function(){o(),t.cancelMultiSel()};n.addEventListener("mousedown",r),n.addEventListener("touchstart",r),n.addEventListener("touchend",o),n.addEventListener("touchcancel",o),n.addEventListener("mouseout",o),n.addEventListener("mouseover",o),n.addEventListener("mouseup",i)},handleLongPress:function(t){this.initMultiSel(),this.$emit("initFloatMsg",{top:t.clientY,left:t.clientX})},handleScroll:function(t){var e=t.target,n=e.scrollLeft,r=e.clientWidth;this.updatedVisibleDays({scrollLeft:n,clientWidth:r})},handleResize:function(){var t=this;if(this.$refs.scroll__container){var e=this.$refs.scroll__container,n=e.scrollLeft,r=e.clientWidth;this.$nextTick((function(){t.updatedVisibleDays({scrollLeft:n,clientWidth:r})}))}},handleOverBlock:function(t){t.target.matches(".block__block, .block__block *")&&this.updatedMulInterval(parseInt(t.target.closest(".block__block").id))},handleMousedownBlock:function(t){this.floatVisible=!1,t.target.matches(".block__block, .block__block *")&&this.setMultiSelStart(parseInt(t.target.closest(".block__block").id))},handleClickBlock:function(t){var e=t.target.closest(".block__block");if(e){var n=parseInt(e.id);e.matches(".chosen")?(this.decSelDayByTime(n),this.delSelBlock(n)):(this.incSelDayByTime(n),this.addSelBlock(n))}},horizontalScroll:function(t){var e=-t.wheelDelta/120;this.$refs.scroll__container.scrollLeft+=50*e},getPixel:function(t){var e=(t-this.originDate)/864e5*this.cardWidth;return e},getShortcut:function(t){var e=this,n=[];return t.shortcut.forEach((function(t){e.events[t]&&n.push(e.events[t])})),n},setRecord:function(t){this.floatVisible=!1,this.$store.dispatch("setRecord",t)}},Object(a["b"])(["updatedMulInterval","delRecord","unselect"])),Object(a["d"])(["initDays","initVisibleDays","updatedVisibleDays","setMulState","incSelDayByTime","decSelDayByTime","addSelBlock","delSelBlock","cancelMultiSel","initMultiSel","setMultiSelStart"]))},ht=dt,pt=(n("e6cf"),Object(h["a"])(ht,g,y,!1,null,null,null)),bt=pt.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"block__actions",staticStyle:{"background-color":"#fff"}},[t.visible?n("ChooseEvent",{attrs:{visible:t.visible,category:t.nowCategory},on:{cancel:t.handleCancel,create:t.handleCreate}}):t._e(),n("div",{staticClass:"search"},[n("a-input",{attrs:{placeholder:"搜索分类名、描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[n("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1)],1),n("div",{staticClass:"block__actions--container"},[t.categorys&&t.categorys.length>0?[n("a-table",{attrs:{columns:t.columns,"data-source":t.categorys,size:"middle",pagination:!1,showHeader:!1,bordered:!1,customRow:t.customRow,locale:{emptyText:"无分类"}},scopedSlots:t._u([{key:"name",fn:function(e,r){return[n("a-tooltip",{staticClass:"category__item",attrs:{placement:"topLeft"}},[n("template",{slot:"title"},[n("span",[t._v(t._s(r.description))])]),"category"===r.type?n("span",{staticClass:"category__item--color",style:"background-color: "+r.color}):t._e(),t._v(" "+t._s(r.name)+" ")],2)]}},{key:"action",fn:function(e,r){return[e?n("a-tooltip",{staticClass:"category__item",attrs:{placement:"left"}},[n("template",{slot:"title"},[n("span",[t._v("更多事件")])]),n("a-icon",{staticClass:"more",attrs:{type:"right-square"},on:{click:function(e){return e.stopPropagation(),t.showEvents(r.category)}}})],2):t._e()]}}],null,!1,1787918235)})]:[n("a-result",{attrs:{"sub-title":t.search?"没有符合条件的分类噢":"还没有分类噢"},scopedSlots:t._u([{key:"icon",fn:function(){return[n("a-icon",{attrs:{type:"smile",theme:"twoTone"}})]},proxy:!0},{key:"extra",fn:function(){return[n("a-button",{attrs:{type:"dashed"},on:{click:function(e){return t.$router.push("/category")}}},[t._v(" 去添加分类 ")])]},proxy:!0}])})]],2)],1)},yt=[],mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{attrs:{visible:t.visible,title:"设置分类["+t.categorys[t.category].name+"]并指定事件为:",footer:null},on:{cancel:function(){t.$emit("cancel")}}},[n("a-input",{attrs:{placeholder:"搜索事件名、描述"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[n("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1),n("a-list",{attrs:{"item-layout":"horizontal","data-source":t.events,pagination:t.pagination,locale:{emptyText:"无事件"}},scopedSlots:t._u([{key:"renderItem",fn:function(e){return n("a-list-item",{on:{click:function(n){return t.$emit("create",{category:t.category,event:e.id})}}},[n("a-list-item-meta",{attrs:{description:e.description}},[n("a",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name)+"["+t._s(e.abbr)+"]")])])],1)}}])})],1)},vt=[];function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){_t(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var wt={props:["visible","category"],data:function(){return{search:"",pagination:{pageSize:5}}},computed:kt({events:function(){var t=[],e=this.$store.getters.events;for(var n in e)e[n].active&&(e[n].name.match(this.search)||e[n].description.match(this.search))&&t.push(e[n]);return t}},Object(a["c"])(["categorys"]))},jt=wt,Dt=Object(h["a"])(jt,mt,vt,!1,null,null,null),Pt=Dt.exports;function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){xt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Et=[{title:"分类",dataIndex:"name",key:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"},align:"right",width:50}],Bt=function(t){return function(e){return{props:{test:10},on:{click:function(){t(e)}}}}},Mt={components:{ChooseEvent:Pt},data:function(){return{visible:!1,columns:Et,customRow:Bt(this.record),search:"",nowCategory:""}},computed:Ct({selectedDays:{get:function(){return this.$store.getters.selectedDays},set:function(t){this.$store.commit("updatedSelectDays",{day:this.day,value:t})}},categorys:function(){var t=this.$store.getters.categorys,e=[],n=0;for(var r in t){var o=t[r];if(t[r].active&&(o.name.match(this.search)||o.description.match(this.search))){for(var i={key:n++,category:o.id,type:"category",name:o.name,color:o.color,description:o.description,action:!0,children:[]},s=0;s<o.shortcut.length;s++){if(!this.events[o.shortcut[s]])break;var a={key:n++,category:o.id,event:o.shortcut[s],type:"event",name:this.events[o.shortcut[s]].name||"",description:this.events[o.shortcut[s]].description||""};i.children.push(a)}i.children.length||delete i.children,e.push(i)}}return e}},Object(a["c"])(["events","hasChosen"])),methods:Ct({showEvents:function(t){this.hasChosen?(this.visible=!0,this.nowCategory=t):this.$message.error("未选择块")},handleCancel:function(){this.visible=!1},handleCreate:function(t){this.visible=!1,this.record(t)},record:function(t){this.setRecord(t)}},Object(a["b"])(["createCategory","setRecord"]))},$t=Mt,Tt=(n("bb50"),Object(h["a"])($t,gt,yt,!1,null,null,null)),Vt=Tt.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.editDesVisible?n("EditDescription",{on:{cancel:t.hideEditDesView,edit:t.changeDes}}):t._e(),n("a-dropdown",{attrs:{trigger:["hover"],placement:"topRight"}},[n("a-button",{staticStyle:{position:"absolute",bottom:"1rem",right:"28rem","z-index":"10"},attrs:{icon:"menu",size:"large"}}),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"nomargin",on:{click:t.togglMargin}},[t.nomargin?n("a-icon",{attrs:{type:"column-height"}}):n("a-icon",{attrs:{type:"vertical-align-middle"}}),t._v(" "+t._s(t.nomargin?"开启":"关闭")+"间隔 ")],1),n("a-menu-item",{key:"export",on:{click:t.exportData}},[n("a-icon",{attrs:{type:"export"}}),t._v("导出数据 ")],1),n("a-menu-item",{key:"uploadData"},[n("a-icon",{attrs:{type:"upload"}}),n("a-upload",{attrs:{name:"file","before-upload":t.beforeUpdate,showUploadList:!1},on:{change:t.handleChange}},[t._v("导入数据 ")])],1),n("a-menu-item",{key:"addDescription",on:{click:t.showEditDesView}},[n("a-icon",{attrs:{type:"file-text"}}),t._v("添加描述 ")],1),n("a-menu-item",{key:"deleteRecord",on:{click:t.delRecord}},[n("a-icon",{attrs:{type:"delete"}}),t._v("删除记录 ")],1),n("a-menu-item",{key:"unselect",on:{click:t.unselect}},[n("a-icon",{attrs:{type:"close-square"}}),t._v("取消选择 ")],1)],1)],1)],1)},zt=[],Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{attrs:{visible:!0,title:"设置描述",okText:"保存",cancelText:"取消"},on:{cancel:function(e){return t.$emit("cancel")},ok:function(e){return t.$emit("edit",t.value)}}},[n("a-textarea",{attrs:{placeholder:"输入描述","allow-clear":""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},Ft=[];function It(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?It(Object(n),!0).forEach((function(e){Jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Nt={data:function(){return{value:""}},methods:{},computed:At({},Object(a["c"])(["categorys"]))},Ht=Nt,Yt=Object(h["a"])(Ht,Rt,Ft,!1,null,null,null),Ut=Yt.exports;class Wt{constructor(){}exportJSON(t={},e){let n=document.createElement("a");e||(e=Date.now()+".json"),/\.json$/.test(e)||(e+=".json"),n.download=e,n.href="data:text/plain,"+JSON.stringify(t),n.click(),n=null}importJSON(){return new Promise((t,e)=>{let n=document.createElement("input");n.type="file",n.onchange=r=>{let o=r.target.files;o&&o.length||(n=null,e(new Error("No files")));let i=new FileReader;i.onload=r=>{try{let e=JSON.parse(r.target.result);t(e)}catch(o){e(o)}n=null},i.readAsText(o[0])},n.click()})}}var qt=new Wt,Xt=n("c1df"),Gt=n.n(Xt);function Kt(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(r,o)}function Qt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){Kt(i,r,o,s,a,"next",t)}function a(t){Kt(i,r,o,s,a,"throw",t)}s(void 0)}))}}function Zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(n),!0).forEach((function(e){ee(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ee(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ne={props:["nomargin"],components:{EditDescription:Ut},data:function(){return{editDesVisible:!1}},computed:te({},Object(a["c"])(["hasChosen","selectedBlocks","blocksState","setting","events","categorys","setting"])),methods:te({hideEditDesView:function(){this.editDesVisible=!1},showEditDesView:function(){if(this.hasChosen){for(var t=!1,e=this.selectedBlocks,n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];if(!this.blocksState[o]){t=!0;break}}t?this.$message.error("有未标记的块"):this.editDesVisible=!0}else this.$message.error("未选择块")},togglMargin:function(){this.$emit("togglMargin")},changeDes:function(t){this.editDesVisible=!1,""===t.trim()&&(t=void 0),this.setDes(t)},exportData:function(){var t=this;return Qt(w.a.mark((function e(){var n,r,o,i,s,a;return w.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.events,r=t.categorys,e.next=4,t.getLogsAll();case 4:o=e.sent,i=t.setting,s={events:n,categorys:r,logs:o,setting:i},a=btoa(encodeURIComponent(JSON.stringify(s))),qt.exportJSON(a,"AikaData - ".concat(Gt()().format("YYYY-MM-DD HH:mm:ss"),".json"));case 9:case"end":return e.stop()}}),e)})))()},beforeUpdate:function(){return!1},handleChange:function(t){var e=this;if("uploading"!==t.file.status)try{var n=new FileReader;n.onload=function(n){try{var r=JSON.parse(n.target.result),o=JSON.parse(decodeURI(decodeURI(atob(r))).replace(/%3A/g,":").replace(/%2C/g,",").replace(/%23/g,"#")),i=[];return i.push(e.setLogsByFile(o.logs)),i.push(e.setCategorysByFile(o.categorys)),i.push(e.setEventsByFile(o.events)),i.push(e.setSettingByFile(o.setting)),Promise.all(i).then((function(){e.$message.success("数据导入成功"),setTimeout((function(){return e.$router.go(0)}),800)})),r}catch(s){throw e.$message.error("".concat(t.file.name," 导入失败.")),new Error(s)}},n.readAsText(t.file)}catch(r){this.$message.error("".concat(t.file.name," 导入失败.")),console.error(r)}"done"===t.file.status?this.$message.success("".concat(t.file.name," 导入成功")):"error"===t.file.status&&this.$message.error("".concat(t.file.name," 导入失败."))}},Object(a["b"])(["delRecord","unselect","setDes","getLogsAll","setLogsByFile","setCategorysByFile","setEventsByFile","setSettingByFile"]))},re=ne,oe=Object(h["a"])(re,Lt,zt,!1,null,null,null),ie=oe.exports,se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"float-msg"},[n("span",{staticClass:"float-interval"},[t._v(t._s(t.selInterval))]),n("span",{staticClass:"float-duration"},[t._v(t._s(t.selDuration))])])},ae=[];function ce(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ce(Object(n),!0).forEach((function(e){ue(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ue(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var fe={computed:le({selInterval:function(){var t=this.selectStart,e=this.selectEnd;if(t>e){var n=[e,t];t=n[0],e=n[1]}return Gt()(t).format("HH:mm")+"~"+Gt()(e+60*this.setting.block.size*1e3).format("HH:mm")},selDuration:function(){var t=this.selectStart,e=this.selectEnd;if(t>e){var n=[e,t];t=n[0],e=n[1]}e+=60*this.setting.block.size*1e3;var r=(e-t)/1e3/60,o=Math.floor(r/60),i=r%60,s=o?o+"小时":"",a=i?i+"分钟":"";return s+a}},Object(a["c"])(["selectStart","selectEnd","setting"]))},de=fe,he=(n("52e5"),Object(h["a"])(de,se,ae,!1,null,null,null)),pe=he.exports,be={components:{BlockTimeScale:b,BlockDateCards:bt,BlockCategoryList:Vt,BlockActions:ie,BlockFloatMessage:pe},data:function(){return{nomargin:!1,floatMsgBox:null,drawerVisible:!0}},computed:{inMul:function(){return this.$store.getters.inMul}},mounted:function(){var t=this;this.$nextTick((function(){t.getFloatMsg()}))},methods:{moment:Gt.a,togglDrawer:function(){this.drawerVisible=!this.drawerVisible},afterVisibleChange:function(t){console.log("visible",t)},showDrawer:function(){this.visible=!0},onClose:function(){this.visible=!1},getFloatMsg:function(){this.floatMsgBox=document.getElementById("floatMsgBox")},initFloatMsg:function(t){var e=t.top,n=t.left;this.setPosition(e,n)},handleMove:function(t){this.inMul&&this.setPosition(t.clientY,t.clientX)},setPosition:function(t,e){this.floatMsgBox||this.getFloatMsg(),this.floatMsgBox.style.top=t-80+"px",this.floatMsgBox.style.left=e-120+"px"},togglMargin:function(){this.nomargin=!this.nomargin}}},ge=be,ye=(n("db1b"),Object(h["a"])(ge,r,o,!1,null,null,null));e["default"]=ye.exports},bb1c:function(t,e,n){},bb50:function(t,e,n){"use strict";var r=n("7249"),o=n.n(r);o.a},db1b:function(t,e,n){"use strict";var r=n("f12d"),o=n.n(r);o.a},e6cf:function(t,e,n){"use strict";var r=n("308f"),o=n.n(r);o.a},f12d:function(t,e,n){}}]);
//# sourceMappingURL=block.bf1b9278.js.map